# 1. 线性规划问题

**线性规划(Linear Programming, LP)** 属于*运筹学*之下的*数学规划*分支中的一个重要分支。

**解决的问题**：在实际的生产实践中，经常会遇到**如何利用现有资源**来安排生产，以取得**最大经济效益**的问题。

## 1.1. 定义

**线性规划问题**是在*一组线性约束条件*的限制下，求*一线性目标函数最大或最小*的问题。

- 解决实际问题时，能否**将问题归结为一个恰当的线性规划数学模型**直接影响到求解。
- 选择**适当的决策变量**是建立有效模型的关键之一。

## 1.2. （数学）标准型与解的概念

### 1.2.1. （数学）标准型

一般线性规划问题的（数学）标准型是

$$
\max \quad z = \sum_{j=1}^n c_j x_j \,, \tag{1}
$$

$$
\text{s.t.} \left\{
\begin{array}{l}
    \displaystyle \sum_{j=1}^n a_{ij} x_j = b_i, i = 1, 2, \ldots, m \,, \\
    x_j \geqslant 0, j = 1, 2, \ldots, n \,. \\
\end{array}
\right. \tag{2}
$$

式中：$b_i\geqslant 0, i = 1, 2, \ldots, m \,.$

- **目标函数**：即式 $(1)$
- **约束条件**：即式 $(2)$

### 1.2.2. 解的概念

- **可行解**：满足约束条件式 $(2)$ 的解 $\boldsymbol{x} = \left[ x_1, \ldots, x_n \right]^\mathrm{T}$
- **最优解**：使得目标函数式 $(1)$ 最大或最小的*可行解* $\boldsymbol{x}^*$
- **可行域**：所有可行解构成的集合，记为 $\mathbf{R}$

## 1.3. 线性规划的 Matlab 标准形式以及软件求解

### 1.3.1. Matlab 标准形式

Matlab 中，线性规划问题的标准形式为：

$$
\min _x \quad \boldsymbol{f}^\mathrm{T}\boldsymbol{x} \,,
$$

$$
\text{s.t.} \left\{
\begin{array}{l}
    \boldsymbol{A} \cdot \boldsymbol{x} \leqslant \boldsymbol{b} \,, \\
    \text{Aeq} \cdot \boldsymbol{x} = \text{beq} \,, \\
    \text{lb} \leqslant \boldsymbol{x} \leqslant \text{ub} \,.
\end{array}
\right.
$$

其中：

- $\boldsymbol{f},\boldsymbol{x},\boldsymbol{b},\text{beq},\text{lb},\text{ub}$ 为*列向量*
    - $\boldsymbol{f}$ 称为**价值向量**
    - $\boldsymbol{x}$ 称为**决策向量**
    - $\boldsymbol{b}$ 称为**资源向量**
- $\boldsymbol{A},\text{Aeq}$ 为矩阵

### 1.3.2. 软件求解

```matlab
[x, fval] = linprog(f, A, b)
[x, fval] = linprog(f, A, b, Aeq, beq)
[x, fval] = linprog(f, A, b, Aeq, beq, lb, ub)
```

其中：

- `x` 返回**决策向量**的取值
- `fval` 返回**目标函数的最优值**
- `A` 和 `b` 对应**线性不等式约束**
- `Aeq` 和 `beq` 对应**线性等式约束**
- `lb` 和 `ub` 对应**决策向量**的**下界向量**和**上界向量**

当线性规划不是 Matlab 标准形式时，需要***将其转换为 Matlab 标准形式***再进行求解。

例如：

$$
\begin{array}{l}
    \displaystyle \max _x \quad \boldsymbol{c}^\mathrm{T}\boldsymbol{x} \,, \\
    \text{s.t.} \quad \boldsymbol{A}\boldsymbol{x} \geqslant \boldsymbol{b} \,.
\end{array}
$$

需要转化为

$$
\begin{array}{l}
    \displaystyle \min _x \quad -\boldsymbol{c}^\mathrm{T}\boldsymbol{x} \,, \\
    \text{s.t.} \quad -\boldsymbol{A}\boldsymbol{x} \leqslant -\boldsymbol{b} \,.
\end{array}
$$

### 1.3.3. 求解示例

#### 1.3.3.1. 例

求解下列线性规划问题：

$$
\begin{array}{l}
\max \quad z = 2x_1 + 3x_2 - 5x_3 \,, \\
\text{s.t.} \left\{
\begin{array}{l}
    x_1 + x_2 + x_3 = 7 \,, \\
    2x_1 - 5x_2 + x_3 \geqslant 10 \,, \\
    x_1 + 3x_2 + x_3 \leqslant 12 \,, \\
    x_1, x_2, x_3 \geqslant 0 \,.
\end{array}
\right.
\end{array}
$$

**解**：

1. 转换为 Matlab 标准形式：

    $$
    \begin{array}{l}
    \displaystyle \min _x \quad w = -2x_1 - 3x_2 + 5x_3 \,, \\
    \text{s.t.} \left\{
    \begin{array}{l}
        \begin{bmatrix}
            -2 & 5 & -1 \\
            1 & 3 & 1 
        \end{bmatrix}
        \begin{bmatrix}
            x_1 \\ x_2 \\ x_3
        \end{bmatrix}
        \leqslant
        \begin{bmatrix}
            -10 \\ 12
        \end{bmatrix} \,,
        \\
        \left[1, 1, 1\right]\cdot\left[x_1, x_2, x_3\right]^\mathrm{T} = 7 \,, \\
        \left[x_1, x_2, x_3\right]^\mathrm{T} \geqslant \left[0, 0, 0\right]^\mathrm{T} \,.
    \end{array}
    \right.
    \end{array}
    $$

2. 求解的 Matlab 代码：

    ```matlab
    f = [-2; -3; 5];
    A = [-2, 5, -1; 1, 3, 1];
    b = [-10; 12];
    Aeq = [1, 1, 1];
    beq = 7;
    lb = [0; 0; 0];
    [x, y] = linprog(f, A, b, Aeq, lb)
    x, y = -y
    ```

## 可转化为线性规划的问题

### 目标函数决策变量均加绝对值

#### 问题

$$
\begin{array}{c}
    \min \quad \left| x_1 \right| + \left| x_2 \right| + \cdots + \left| x_n \right| \,, \\
    \text{s.t.} \quad \boldsymbol{Ax} \leqslant \boldsymbol{b} \,.
\end{array}
$$

其中，$\boldsymbol{x} = \left[ x_1, x_2, \cdots, x_n \right]^\mathrm{T}$，$\boldsymbol{A}$ 为 $m \times n$ 矩阵，$\boldsymbol{b}$ 为 $m$ 维向量。

将其转变为线性规划问题，**关键在于以下事实**：

对于任意的 $x_i$，均存在 $u_i, v_i \geqslant 0$ 满足

$$
x_i = u_i - v_i \,, |x_i| = u_i + v_i \,.
$$

反解出 $\displaystyle u_i = \frac{|x_i| + x_i}{2}, v_i = \frac{|x_i| - x_i}{2}$，就可以满足 $u_i, v_i \geqslant 0$。

记 $\boldsymbol{u} = [ u_1, \ldots, u_n ]^\mathrm{T} , \boldsymbol{v} = [ v_1, \ldots, v_n ]^\mathrm{T}$，就可以将上面的数学规划问题转变为线性规划问题：

$$
\begin{array}{l}\displaystyle
    \min \quad \sum_{i=1}^n (u_i + v_i) \,, \\
    \text{s.t.} \quad \left\{
        \begin{array}{l}
            \boldsymbol{A}(\boldsymbol{u} - \boldsymbol{v}) \leqslant \boldsymbol{b} \,, \\
            \boldsymbol{u}, \boldsymbol{v} \geqslant 0 \,.
        \end{array}
    \right.
\end{array}
$$

进一步化简得到

$$
\begin{array}{l}\displaystyle
    \min \quad \sum_{i=1}^n (u_i + v_i) \,, \\
    \text{s.t.} \quad \left\{
        \begin{array}{l}
            [\boldsymbol{A}, -\boldsymbol{A}]
            \begin{bmatrix}
                \boldsymbol{u} \\ \boldsymbol{v}
            \end{bmatrix} 
            \leqslant \boldsymbol{b} \,, \\
            \boldsymbol{u}, \boldsymbol{v} \geqslant 0 \,.
        \end{array}
    \right.
\end{array}
$$

#### 例

求下列数学规划问题：

$$
\begin{array}{l}
\min \quad z = |x_1| + 2|x_2| + 3|x_3| + 4|x_4| \,, \\
\text{s.t.} \left\{
\begin{array}{l}
    x_1 - x_2 - x_3 + x_4 \leqslant -2 \,, \\
    x_1 - x_2 + x_3 - 3x_4 \leqslant -1 \,, \\
    x_1 - x_2 - 2x_3 + 3x_4 \leqslant -\dfrac{1}{2} \,.
\end{array}
\right.
\end{array}
$$

解：

1. 